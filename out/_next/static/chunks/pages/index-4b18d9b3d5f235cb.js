(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2061:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var l=n(7876),r=n(4232),a=n(9099);function c(e){let{selected:t,onSelect:n,type:a}=e,[c,s]=(0,r.useState)({}),[o,u]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{let e=await fetch("/hightemp-map/data/history-".concat(a,".json")),t=await e.json();s(t.grouped),u(t.recent)})()},[a]),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{children:"直近10件"}),(0,l.jsxs)("select",{value:null!=t?t:"",onChange:e=>n(e.target.value||null),className:"border px-2 py-1",children:[(0,l.jsx)("option",{value:"",children:"最新"}),o.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("hr",{}),(0,l.jsx)("label",{children:"履歴を日付から"}),Object.entries(c).map(e=>{let[t,r]=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-bold",children:t}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(e=>(0,l.jsx)("button",{onClick:()=>n("".concat(t,"-").concat(e)),className:"border px-2 py-1 text-sm",children:e},e))})]},t)})]})}function s(){let e=(0,a.useRouter)(),t="low"===e.query.type?"low":"high",n="string"==typeof e.query.date?e.query.date:"",r=t=>{e.push({pathname:e.pathname,query:{...e.query,type:t,date:void 0}})};return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between border-b mb-4 p-2",children:[(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("button",{onClick:()=>r("high"),className:"px-4 py-2 ".concat("high"===t?"border-b-2 border-blue-500 font-bold":"text-gray-500"),children:"☀️ 最高気温"}),(0,l.jsx)("button",{onClick:()=>r("low"),className:"px-4 py-2 ".concat("low"===t?"border-b-2 border-blue-500 font-bold":"text-gray-500"),children:"❄️ 最低気温"})]}),(0,l.jsx)("div",{className:"mt-2 md:mt-0",children:(0,l.jsx)(c,{selected:n||null,onSelect:t=>{e.push({pathname:e.pathname,query:{...e.query,date:t||void 0}})},type:t})})]})}let o=e=>{let t=Number(e);return 1===t?"#FF0000":2===t?"#FF8C00":3===t?"#FFFF00":t>=4&&t<=6?"#ADFF2F":t>=7&&t<=10?"#00BFFF":"#808080"};function u(e){let{data:t,selectedId:n,onSelect:a}=e,c=(0,r.useRef)(null),s=(0,r.useRef)(null),u=(0,r.useRef)({}),i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!c.current||s.current)return;let e=setInterval(()=>{window.google&&window.google.maps&&c.current&&(s.current=new window.google.maps.Map(c.current,{center:{lat:37,lng:139},zoom:5}),i.current=new window.google.maps.InfoWindow,clearInterval(e))},100);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>{s.current&&(Object.values(u.current).forEach(e=>e.setMap(null)),u.current={},t.forEach(e=>{if(!e.lat||!e.lon)return;let t=new google.maps.Marker({position:{lat:e.lat,lng:e.lon},map:s.current,label:"".concat(e.rank),icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:o(e.rank),fillOpacity:1,strokeWeight:1,strokeColor:"#333"}});t.addListener("click",()=>{var n,l;a(e.code),null==(n=i.current)||n.setContent("<strong>".concat(e.rank,"位</strong><br>").concat(e.pref," ").concat(e.city,"<br>").concat(e.temp,"℃ (").concat(e.time,")")),null==(l=i.current)||l.open(s.current,t),s.current.panTo({lat:e.lat,lng:e.lon}),s.current.setZoom(7)}),u.current[e.code||""]=t}))},[t,a]),(0,r.useEffect)(()=>{if(!s.current||!n)return;let e=t.find(e=>e.code===n),l=u.current[n];if(e&&l){var r,a;null==(r=i.current)||r.setContent("<strong>".concat(e.rank,"位</strong><br>").concat(e.pref," ").concat(e.city,"<br>").concat(e.temp,"℃ (").concat(e.time,")")),null==(a=i.current)||a.open(s.current,l),s.current.panTo({lat:e.lat,lng:e.lon}),s.current.setZoom(7)}},[n,t]),(0,l.jsx)("div",{ref:c,className:"w-full h-full"})}let i=e=>{let t=Number(e);return 1===t?"#FF0000":2===t?"#FF8C00":3===t?"#FFFF00":t>=4&&t<=6?"#ADFF2F":t>=7&&t<=10?"#00BFFF":"#808080"};function d(e){let{data:t,selectedId:n,onSelect:r}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold mb-2",children:"ランキング"}),(0,l.jsx)("ul",{children:t.map(e=>(0,l.jsxs)("li",{className:"p-2 cursor-pointer ".concat(n===e.code?"bg-blue-100":""),onClick:()=>r(e.code),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"inline-block w-[12px] h-[12px] rounded-full",style:{backgroundColor:i(Number(e.rank))}}),"#",e.rank," ",e.pref," ",e.city]}),(0,l.jsxs)("span",{children:[e.temp,"℃"]})]}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:e.time})]},"".concat(e.code,"-").concat(e.rank)))})]})}function p(){let e=(0,a.useRouter)(),t="low"===e.query.type?"low":"high",n=e.query.date,[c,o]=(0,r.useState)([]),[i,p]=(0,r.useState)(null);return(0,r.useEffect)(()=>{e.isReady&&(async()=>{let e="/hightemp-map/data/".concat(t,"/").concat(n?"".concat(n,".json"):"latest.json"),l=await fetch(e),r=await l.json(),a=await fetch("/hightemp-map/amedas.json"),c=await a.json();o(r.map(e=>{let t=c.find(t=>t.code===e.code);return{...e,lat:null==t?void 0:t.lat,lon:null==t?void 0:t.lon,group:null==t?void 0:t.group,kana:null==t?void 0:t.kana}}))})()},[t,n,e.isReady]),(0,l.jsxs)("main",{className:"flex flex-col h-screen",children:[(0,l.jsx)(s,{}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row flex-1 h-full",children:[(0,l.jsx)("section",{className:"w-full md:w-1/3 p-4 border border-blue-500 overflow-y-auto",children:(0,l.jsx)(d,{data:c,selectedId:i,onSelect:p})}),(0,l.jsx)("section",{className:"flex-1 border border-green-500",children:(0,l.jsx)(u,{data:c,selectedId:i,onSelect:p})})]})]})}},6760:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2061)}])},9099:(e,t,n)=>{e.exports=n(8253)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6760)),_N_E=e.O()}]);